# Contributing Guidelines

Thanks for contributing! This project is an Obsidian plugin with a layered architecture and a few helper tools to keep the codebase consistent and testable.

## Code Organization

- App: `src/app` — entry + orchestration (`main.ts`, `commands.ts`, `sync-ui.ts`, `logging.ts`).
- UI: `src/ui` — settings tabs and modals.
- Features: `src/features/keep` — normalization, compare/merge, sync orchestration, attachments.
- Integrations: `src/integrations` — server API and Google OAuth/token flow.
- Services: `src/services` — http, subscription, paths, logger, errors.
- Schemas: `src/schemas` — Zod schemas for runtime validation.
- Types: `src/types` — shared TS types and defaults.
- Test utils: `src/test-utils` — fixtures and mocks.

## Naming & Imports

- Use path aliases: `@app/*`, `@ui/*`, `@features/*`, `@integrations/*`, `@services/*`, `@types/*`, `@schemas/*`.
- Only import types from `@types/*` using `import type`. Runtime imports from `@types/*` are restricted in ESLint.
- Keep files focused and cohesive; avoid cross-layer imports that break boundaries.

## Barrels

- Barrels are generated by `barrelsby` before builds.
- Config: `config/barrelsby.json`.
- Command: `npm run barrels` (runs automatically in `prebuild`).
- Avoid hand-editing generated `index.ts` barrel files.

## Validation & Errors

- Use schemas in `@schemas/*` to validate external payloads.
- Use typed errors in `@services/errors` for network/parse/IO errors.
- Surface friendly messages to users and log details for debugging.

## Linting & Tests

- Lint TS: `npm run lint:ts`; Markdown: `npm run lint:md`.
- Tests: `npm run test`; Coverage: `npm run coverage`.
- Place unit tests near features: `src/**/tests/*.test.ts`.

## Build & Dev

- Dev: `npm run dev` (esbuild watch).
- Build: `npm run build` (lint + typecheck + bundle).
- Ensure `manifest.json` matches `main.js` via `npm run version` when releasing.

